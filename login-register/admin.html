<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå°</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/pages/admin.css">


</head>
<body class="admin-page">
    <div class="admin-sidebar">
        <h3 class="admin-sidebar-title">é¤é¥®ç®¡ç†ç³»ç»Ÿ</h3>
        <ul class="admin-menu">
            <li class="admin-menu-item"><a href="#" class="admin-menu-link active" onclick="showPage('dashboard', this)">ä»ªè¡¨ç›˜</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('menu-categories', this)">èœå“åˆ†ç±»</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('menu-items', this)">èœå“ç®¡ç†</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('tables', this)">æ¡Œå°ç®¡ç†</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('dining-orders', this)">ç‚¹é¤è®¢å•</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('users', this)">ç”¨æˆ·ç®¡ç†</a></li>
            <li class="admin-menu-item"><a href="#" class="admin-menu-link" onclick="showPage('settings', this)">ç³»ç»Ÿè®¾ç½®</a></li>
        </ul>
    </div>

    <div class="admin-main">
        <div class="admin-header">
            <h1 class="admin-header-title">é¤é¥®ç®¡ç†ç³»ç»Ÿ</h1>
            <div class="admin-user-info">
                <span class="admin-user-name">æ¬¢è¿ï¼Œ<span id="username">Admin</span></span>
                <button class="admin-logout-btn" onclick="logout()">é€€å‡ºç™»å½•</button>
            </div>
        </div>

        <div class="admin-content">
            <!-- ä»ªè¡¨ç›˜é¡µé¢ -->
            <div id="dashboard" class="admin-page-container active">
                <h2 class="admin-page-title">ä»ªè¡¨ç›˜</h2>
                <div class="admin-welcome-message">
                    æ¬¢è¿æ¥åˆ°é¤é¥®ç®¡ç†ç³»ç»Ÿï¼
                </div>
                <div class="admin-stats-grid">
                    <div class="admin-stat-card primary">
                        <h3 class="admin-stat-title">ä»Šæ—¥è¥ä¸šé¢</h3>
                        <div class="admin-stat-number">Â¥8,888</div>
                    </div>
                    <div class="admin-stat-card success">
                        <h3 class="admin-stat-title">ä»Šæ—¥è®¢å•æ•°</h3>
                        <div class="admin-stat-number">156</div>
                    </div>
                    <div class="admin-stat-card warning">
                        <h3 class="admin-stat-title">èœå“æ€»æ•°</h3>
                        <div class="admin-stat-number">89</div>
                    </div>
                    <div class="admin-stat-card info">
                        <h3 class="admin-stat-title">æ¡Œå°æ€»æ•°</h3>
                        <div class="admin-stat-number">24</div>
                    </div>
                </div>
            </div>

            <!-- èœå“åˆ†ç±»é¡µé¢ -->
            <div id="menu-categories" class="admin-page-container">
                <div class="admin-page-header">
                    <h2 class="admin-page-title">èœå“åˆ†ç±»ç®¡ç†</h2>
                    <div class="admin-page-actions">
                        <button class="btn btn-success" onclick="adminManager.addCategory()">æ·»åŠ åˆ†ç±»</button>
                    </div>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>åˆ†ç±»ID</th>
                            <th>åˆ†ç±»åç§°</th>
                            <th>èœå“æ•°é‡</th>
                            <th>çŠ¶æ€</th>
                            <th>åˆ›å»ºæ—¶é—´</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- èœå“ç®¡ç†é¡µé¢ -->
            <div id="menu-items" class="admin-page-container">
                <div class="admin-page-header">
                    <h2 class="admin-page-title">èœå“ç®¡ç†</h2>
                    <div class="admin-page-actions">
                        <button class="btn btn-success" onclick="adminManager.addMenuItem()">æ·»åŠ èœå“</button>
                    </div>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>èœå“ID</th>
                            <th>èœå“åç§°</th>
                            <th>åˆ†ç±»</th>
                            <th>ä»·æ ¼</th>
                            <th>åº“å­˜</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- æ¡Œå°ç®¡ç†é¡µé¢ -->
            <div id="tables" class="admin-page-container">
                <div class="admin-page-header">
                    <h2 class="admin-page-title">æ¡Œå°ç®¡ç†</h2>
                    <div class="admin-page-actions">
                        <button class="btn btn-success" onclick="adminManager.addTable()">æ·»åŠ æ¡Œå°</button>
                    </div>
                </div>
                <div class="admin-stats-grid">
                    <div class="admin-stat-card primary">
                        <h3 class="admin-stat-title">æ€»æ¡Œå°æ•°</h3>
                        <div class="admin-stat-number">24</div>
                    </div>
                    <div class="admin-stat-card success">
                        <h3 class="admin-stat-title">ç©ºé—²æ¡Œå°</h3>
                        <div class="admin-stat-number">18</div>
                    </div>
                    <div class="admin-stat-card warning">
                        <h3 class="admin-stat-title">å ç”¨æ¡Œå°</h3>
                        <div class="admin-stat-number">6</div>
                    </div>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>æ¡Œå°ID</th>
                            <th>æ¡Œå°ç¼–å·</th>
                            <th>æ¡Œå°åç§°</th>
                            <th>åº§ä½æ•°</th>
                            <th>ä½ç½®</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- ç‚¹é¤è®¢å•é¡µé¢ -->
            <div id="dining-orders" class="admin-page-container">
                <h2 class="admin-page-title">ç‚¹é¤è®¢å•ç®¡ç†</h2>
                <div class="admin-stats-grid">
                    <div class="admin-stat-card primary">
                        <h3 class="admin-stat-title">ä»Šæ—¥è®¢å•</h3>
                        <div class="admin-stat-number">156</div>
                    </div>
                    <div class="admin-stat-card warning">
                        <h3 class="admin-stat-title">å¾…å¤„ç†</h3>
                        <div class="admin-stat-number">12</div>
                    </div>
                    <div class="admin-stat-card info">
                        <h3 class="admin-stat-title">åˆ¶ä½œä¸­</h3>
                        <div class="admin-stat-number">8</div>
                    </div>
                    <div class="admin-stat-card success">
                        <h3 class="admin-stat-title">å·²å®Œæˆ</h3>
                        <div class="admin-stat-number">136</div>
                    </div>
                </div>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>è®¢å•ID</th>
                            <th>è®¢å•å·</th>
                            <th>æ¡Œå°</th>
                            <th>æ€»é‡‘é¢</th>
                            <th>çŠ¶æ€</th>
                            <th>ä¸‹å•æ—¶é—´</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- ç”¨æˆ·ç®¡ç†é¡µé¢ -->
            <div id="users" class="admin-page-container">
                <h2 class="admin-page-title">ç”¨æˆ·ç®¡ç†</h2>
                <table class="admin-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>ç”¨æˆ·å</th>
                            <th>é‚®ç®±</th>
                            <th>æ³¨å†Œæ—¶é—´</th>
                            <th>è§’è‰²</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- æ•°æ®å°†é€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                    </tbody>
                </table>
            </div>

            <!-- ç³»ç»Ÿè®¾ç½®é¡µé¢ -->
            <div id="settings" class="admin-page-container">
                <h2 class="admin-page-title">ç³»ç»Ÿè®¾ç½®</h2>
                <form id="settings-form" class="admin-form">
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="restaurant-name">é¤å…åç§°</label>
                        <input class="admin-form-control" type="text" id="restaurant-name" name="restaurant_name">
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="restaurant-address">é¤å…åœ°å€</label>
                        <input class="admin-form-control" type="text" id="restaurant-address" name="restaurant_address">
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="restaurant-phone">è”ç³»ç”µè¯</label>
                        <input class="admin-form-control" type="text" id="restaurant-phone" name="restaurant_phone">
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="business-hours">è¥ä¸šæ—¶é—´</label>
                        <input class="admin-form-control" type="text" id="business-hours" name="business_hours">
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="tax-rate">ç¨ç‡è®¾ç½®</label>
                        <input class="admin-form-control" type="number" id="tax-rate" name="tax_rate" step="0.01" min="0" max="1">
                    </div>
                    <div class="admin-form-group">
                        <label class="admin-form-label" for="service-charge">æœåŠ¡è´¹ç‡</label>
                        <input class="admin-form-control" type="number" id="service-charge" name="service_charge" step="0.01" min="0" max="1">
                    </div>
                    <button type="submit" class="btn btn-primary">ä¿å­˜è®¾ç½®</button>
                </form>
            </div>
        </div>
    </div>

    <!-- å¼•å…¥APIå’Œç®¡ç†è„šæœ¬ -->
    <script src="js/api.js"></script>
    <script src="js/cookie-utils.js"></script>
    <script src="js/admin.js"></script>
    <script src="admin-edit-test.js"></script>

    <!-- è°ƒè¯•å’Œæµ‹è¯•è„šæœ¬ -->
    <script>
        // æ·»åŠ è°ƒè¯•ä¿¡æ¯å’Œæµ‹è¯•æŒ‰é’®
        window.addEventListener('load', function() {
            console.log('ğŸ¯ Adminé¡µé¢åŠ è½½å®Œæˆ');
            console.log('AdminManager:', window.adminManager);

            // æ·»åŠ æµ‹è¯•æŒ‰é’®
            setTimeout(() => {
                if (window.adminManager) {
                    console.log('âœ… AdminManagerå·²åˆå§‹åŒ–');

                    // åœ¨é¡µé¢é¡¶éƒ¨æ·»åŠ æµ‹è¯•æ§åˆ¶é¢æ¿
                    const testPanel = document.createElement('div');
                    testPanel.id = 'test-panel';
                    testPanel.style.cssText = `
                        position: fixed;
                        top: 10px;
                        right: 10px;
                        z-index: 999;
                        background: white;
                        padding: 15px;
                        border: 1px solid #ddd;
                        border-radius: 8px;
                        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                        font-family: Arial, sans-serif;
                        min-width: 200px;
                    `;
                    testPanel.innerHTML = `
                        <div style="font-weight: bold; margin-bottom: 10px; color: #333; text-align: center;">
                            ğŸ§ª ç¼–è¾‘åŠŸèƒ½æµ‹è¯•é¢æ¿
                        </div>
                        <div style="margin-bottom: 8px;">
                            <strong>å•é¡¹æµ‹è¯•:</strong>
                        </div>
                        <button onclick="window.adminManager.editCategory(1)"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #007bff; background: #007bff; color: white; border-radius: 3px; cursor: pointer;">
                            ğŸ“‚ æµ‹è¯•åˆ†ç±»ç¼–è¾‘
                        </button>
                        <button onclick="window.adminManager.editMenuItem(1)"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #28a745; background: #28a745; color: white; border-radius: 3px; cursor: pointer;">
                            ğŸ½ï¸ æµ‹è¯•èœå“ç¼–è¾‘
                        </button>
                        <button onclick="window.adminManager.editTable(1)"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #ffc107; background: #ffc107; color: black; border-radius: 3px; cursor: pointer;">
                            ğŸª‘ æµ‹è¯•æ¡Œå°ç¼–è¾‘
                        </button>
                        <button onclick="window.adminManager.editUser(1)"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #6f42c1; background: #6f42c1; color: white; border-radius: 3px; cursor: pointer;">
                            ğŸ‘¤ æµ‹è¯•ç”¨æˆ·ç¼–è¾‘
                        </button>
                        <hr style="margin: 10px 0; border: none; border-top: 1px solid #eee;">
                        <div style="margin-bottom: 8px;">
                            <strong>è‡ªåŠ¨åŒ–æµ‹è¯•:</strong>
                        </div>
                        <button onclick="testAdminEdit()"
                                style="width: 100%; margin: 2px 0; padding: 8px; font-size: 12px; border: 1px solid #dc3545; background: #dc3545; color: white; border-radius: 3px; cursor: pointer; font-weight: bold;">
                            ğŸš€ è¿è¡Œå…¨éƒ¨æµ‹è¯•
                        </button>
                        <button onclick="console.clear(); console.log('ğŸ§¹ æ§åˆ¶å°å·²æ¸…ç©º')"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #6c757d; background: #6c757d; color: white; border-radius: 3px; cursor: pointer;">
                            ğŸ§¹ æ¸…ç©ºæ§åˆ¶å°
                        </button>
                        <button onclick="document.getElementById('test-panel').style.display='none'"
                                style="width: 100%; margin: 2px 0; padding: 6px; font-size: 12px; border: 1px solid #ccc; background: #f8f9fa; color: #333; border-radius: 3px; cursor: pointer;">
                            âŒ éšè—é¢æ¿
                        </button>
                    `;
                    document.body.appendChild(testPanel);

                    console.log('ğŸ›ï¸ æµ‹è¯•é¢æ¿å·²æ·»åŠ åˆ°é¡µé¢å³ä¸Šè§’');
                    console.log('ğŸ’¡ ä½¿ç”¨è¯´æ˜:');
                    console.log('   - ç‚¹å‡»å•é¡¹æµ‹è¯•æŒ‰é’®æµ‹è¯•ç‰¹å®šç¼–è¾‘åŠŸèƒ½');
                    console.log('   - ç‚¹å‡»"è¿è¡Œå…¨éƒ¨æµ‹è¯•"è¿›è¡Œå®Œæ•´çš„è‡ªåŠ¨åŒ–æµ‹è¯•');
                    console.log('   - æŸ¥çœ‹æ§åˆ¶å°è¾“å‡ºè·å–è¯¦ç»†æµ‹è¯•ç»“æœ');

                } else {
                    console.warn('âš ï¸ AdminManageræœªåœ¨é¢„æœŸæ—¶é—´å†…åˆå§‹åŒ–ï¼Œå°è¯•æ‰‹åŠ¨åˆå§‹åŒ–...');
                    try {
                        if (typeof AdminManager !== 'undefined') {
                            window.adminManager = new AdminManager();
                            console.log('âœ… AdminManageræ‰‹åŠ¨åˆå§‹åŒ–æˆåŠŸ');
                        } else {
                            console.error('âŒ AdminManagerç±»æœªå®šä¹‰');
                        }
                    } catch (error) {
                        console.error('âŒ æ‰‹åŠ¨åˆå§‹åŒ–å¤±è´¥:', error.message);
                    }
                }
            }, 2000);
        });

        // æ·»åŠ é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', function(e) {
            // Ctrl + T è¿è¡Œæµ‹è¯•
            if (e.ctrlKey && e.key === 't') {
                e.preventDefault();
                if (window.testAdminEdit) {
                    console.log('ğŸ¯ å¿«æ·é”®è§¦å‘: å¼€å§‹è¿è¡Œå…¨éƒ¨æµ‹è¯•...');
                    testAdminEdit();
                }
            }

            // Ctrl + H æ˜¾ç¤º/éšè—æµ‹è¯•é¢æ¿
            if (e.ctrlKey && e.key === 'h') {
                e.preventDefault();
                const panel = document.getElementById('test-panel');
                if (panel) {
                    panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                }
            }
        });

        console.log('âŒ¨ï¸ å¿«æ·é”®å·²å¯ç”¨:');
        console.log('   Ctrl + T: è¿è¡Œå…¨éƒ¨æµ‹è¯•');
        console.log('   Ctrl + H: æ˜¾ç¤º/éšè—æµ‹è¯•é¢æ¿');
    </script>
</body>
</html>